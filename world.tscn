[gd_scene load_steps=8 format=3 uid="uid://b2lvgyma5tocx"]

[ext_resource type="PackedScene" uid="uid://dftaxyvi8c7gh" path="res://player.tscn" id="1_3x6ce"]
[ext_resource type="PackedScene" uid="uid://de8400b53dsqj" path="res://camera.tscn" id="3_5o7i2"]
[ext_resource type="PackedScene" uid="uid://cmp2w3c3ngstb" path="res://stage.tscn" id="3_pfher"]
[ext_resource type="PackedScene" uid="uid://cmnvrn4vf7bj0" path="res://monster.tscn" id="3_vabds"]

[sub_resource type="GDScript" id="GDScript_56o48"]
script/source = "extends Node2D


# Called when the node enters the scene tree for the first time.
func _ready():
	$Camera.target = $Player
	$Monster.target = $Player

func _on_player_fire_bullet(transform):
	$BulletManager.fire(transform)
	$Camera.add_trauma(0.2, 0.3)


func _on_monster_death(transform, explosion):
	add_child(explosion)
	explosion.global_transform = transform
	explosion.emitting = true
"

[sub_resource type="Environment" id="Environment_v7shs"]
background_mode = 3
glow_enabled = true
glow_normalized = true
glow_strength = 1.37
glow_blend_mode = 0

[sub_resource type="GDScript" id="GDScript_1fqsf"]
script/source = "extends Node2D

var Bullet := preload(\"res://bullet.tscn\")

# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

func fire(transform):
	var bullet := Bullet.instantiate()
	bullet.transform = transform
	add_child(bullet)
"

[node name="World" type="Node2D"]
script = SubResource("GDScript_56o48")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_v7shs")

[node name="Stage" parent="." instance=ExtResource("3_pfher")]
position = Vector2(403, -15)

[node name="Player" parent="." instance=ExtResource("1_3x6ce")]

[node name="Camera" parent="." instance=ExtResource("3_5o7i2")]

[node name="BulletManager" type="Node2D" parent="."]
script = SubResource("GDScript_1fqsf")

[node name="Monster" parent="." instance=ExtResource("3_vabds")]
position = Vector2(366, -53)

[connection signal="fire_bullet" from="Player" to="." method="_on_player_fire_bullet"]
[connection signal="death" from="Monster" to="." method="_on_monster_death"]
